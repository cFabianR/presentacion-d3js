<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>D3.js y React, trabajando juntos</title>
  <meta name="description" content="Presentación para la charla 'D3.js y React, trabajando juntos'">
  <meta name="author" content="Javier Calzado">

  <!-- Config -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <!-- Temas Reveal y custom -->
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/fjcalzado.css" id="theme">

  <!-- Tema para sintaxis de código -->
  <link rel="stylesheet" href="lib/css/zenburn.css">

  <!-- Printing and PDF exports -->
  <script>
    const link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>

  <!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
</head>

<body>

  <div class="reveal">
    <div class="slides">

      <!-- Slide - Apertura -->
      <section>

        <object type="image/svg+xml" data="media/osc_logo.svg" height="120">Open South Code Logo</object>
        <h1 class="space-up-down">
          React y D3.js, trabajando juntos
        </h1>
        <div class="pulse-glow">
          <a target="_blank" class="bottom" href="https://fjcalzado.surge.sh">fjcalzado.surge.sh</a>
        </div>

        <!-- Notas -->
        <aside class="notes">
          Notas Aqui:
        </aside>

      </section>

      <!-- |GRUPO| Resumen Contenido -->
      <section>

        <!-- Slide - Introducción -->
        <section>
          <object class="fragment" data-fragment-index="1" data-autoslide="2000"
            type="image/svg+xml" data="media/react_logo.svg" height="180">React Logo</object>
          <svg class="fragment pulse-size" data-fragment-index="3" style="margin: 0 50px"
            height="160" viewbox="0 0 16 16">
            <path d="m417.59 527.35c-.653-.644-1.555-.965-2.707-.965-.319 0-.644.056-.976.167-.332.112-.64.262-.926.452-.285.189-.531.367-.737.533-.206.166-.401.343-.586.529-.185-.187-.381-.363-.586-.529-.206-.166-.451-.344-.737-.533-.285-.189-.594-.34-.926-.452-.332-.112-.657-.167-.976-.167-1.152 0-2.054.322-2.707.965-.653.644-.98 1.536-.98 2.678 0 .348.06.706.181 1.074.121.369.258.683.413.942.154.259.329.513.524.759.195.247.338.416.428.51.09.093.161.161.212.202l4.813 4.687c.093.094.206.14.339.14.134 0 .247-.047.339-.14l4.805-4.672c1.178-1.189 1.766-2.356 1.766-3.504 0-1.142-.327-2.035-.98-2.678" fill="#f11" transform="translate(-403.7-524.37)"/>
          </svg>
          <object class="fragment" data-fragment-index="2" data-autoslide="2000"
            type="image/svg+xml" data="media/d3_logo.svg" height="180">React Logo</object>

          <!-- Notas -->
          <aside class="notes">
              Notas Aqui:
          </aside>
        </section>

        <!-- Slide - Contenido -->
        <section>
          <h2>Contenido</h2>
          <ul>
            <li class="fragment"><a target="_blank" href="https://reactjs.org/">React</a></li>
            <li class="fragment"><a target="_blank" href="https://d3js.org/">D3.js</a></li>
            <li class="fragment">Problemática React + D3.js</li>
            <li class="fragment">Soluciones y ejemplos</li>
          </ul>

          <!-- Notas -->
          <aside class="notes">
              Notas Aqui:
          </aside>
        </section>

      </section>

      <!-- |GRUPO| React -->
      <section>

        <!-- Slide - React Intro -->
        <section>
          <div class="flex-row center">
            <object type="image/svg+xml" data="media/react_logo.svg" height="75">React Logo</object>
            <h2 class="header-in-row">React</h2>
          </div>
          <ul>
            <li class="fragment">Construcción de Interfaces de Usuario</li>
            <li class="fragment">Componentes reusables</li>
            <li class="fragment">Declarativo, nos abstrae de modificar el DOM</li>
            <li class="fragment"><i>DOM Virtual</i></li>
          </ul>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>Librería tremendamente popular que nos permite construir interfaces de usuario.</li>
              <li>Basado en componentes: pequeños elementos funcionales (un botón, un input, etc) que gracias a la composición forman componentes más complejos.</li>
              <li>Declarativo, le decimos QUE queremos representar pero no COMO hacerlo, no hay que especificar cómo cambiar el DOM, React se encarga de eso por nosotros, nos abstrae de esa tarea.</li>
              <li>Una de sus claves de éxito (inmutabilidad, one way, etc), la que nos interesa, es el manejo eficiente del DOM que realiza gracias al DOM VIRTUAL. Mutaciones eficientes en el DOM Real.</li>
            </ul>
          </aside>
        </section>

        <!-- Slide - DOM Real vs DOM Virtual -->
        <section>
          <div class="flex-row spaced">
            <div>
              <h3>DOM Real</h3>
              <ul>
                <li class="fragment">Navegador</li>
                <li class="fragment">Pesado</li>
                <li class="fragment">Cambios Costosos</li>
              </ul>
            </div>
            <div>
              <h3>DOM Virtual</h3>
              <ul>
                <li class="fragment">En Memoria</li>
                <li class="fragment">Ligero</li>
                <li class="fragment">Cambios Baratos</li>
              </ul>
            </div>
          </div>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>El DOM real esta ligado al navegador, es el documento que representa la página o aplicación que vemos en nuestro navegador.</li>
              <li>Es una entidad pesada, con una API grande a su alrededor</li>
              <li>Las actualizaciones del DOM son operaciones costosas para el navegador. Por tanto, mutar el DOM cada vez que el usuario interactúa con la UI puede ser ineficiente.</li>
              <li>En cambio el DOM virtual es una representación en memoria del DOM real.</li>
              <li>Es una entidad ligera y rápida</li>
              <li>Y los cambio son por tanto mucho más baratos</li>
            </ul>
          </aside>
        </section>

        <!-- Slide - Reconciliación -->
        <section>
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            viewbox="0 0 960 560.5" style="enable-background:new 0 0 960 560.5;" xml:space="preserve">
            <defs>
              <style type="text/css">
                .svg-a-rule2{fill:#FCFCFD;}
                .svg-a-rule3{fill:#4F5565;}
                .svg-a-rule4{fill:#FFFFFF;}
                .svg-a-rule5{fill:#333842;}
                .svg-a-rule6{fill:#00D4EC;}
                .svg-a-rule7{fill:none;stroke:#FF55F7;stroke-width:5;stroke-miterlimit:10;}
                .svg-a-rule8{fill:none;stroke:#00D4EC;stroke-width:5;stroke-miterlimit:10;}
                .svg-a-rule9{fill:#FF55F7;stroke:#FF55F7;stroke-width:3;stroke-miterlimit:10;}
                .svg-a-rule10{fill:#00D4EC;stroke:#00D4EC;stroke-width:3;stroke-miterlimit:10;}
                .svg-a-rule11{font-family:'Montserrat';}
                .svg-a-rule12{font-size:32px;}
                .svg-a-rule13{fill:#7F7F7F;stroke:#7F7F7F;stroke-width:3;stroke-miterlimit:10;}
                .svg-a-rule14{fill:#7F7F7F;stroke:#7F7F7F;stroke-width:5;stroke-miterlimit:10;}
                .svg-a-rule15{font-size:38px;}
                .svg-a-rule16{fill:#FFFFFF;}
                .svg-a-rule17{opacity:0.4;}
                .svg-a-rule18{fill:none;stroke:#FFFFFF;stroke-width:3;stroke-miterlimit:10;}
                .svg-a-rule19{fill:none;stroke:#FFFFFF;stroke-width:3;stroke-miterlimit:10;stroke-dasharray:11.8286,11.8286;}
              </style>
            </defs>
            <g id="UI">
              <g>
                <path class="svg-a-rule2" d="M17.8,211.2v174.7c0,4.7,3.8,8.5,8.5,8.5h237.1c4.7,0,8.5-3.8,8.5-8.5V211.2H17.8z"/>
                <path class="svg-a-rule3" d="M271.8,181.7c0-4.7-3.8-8.5-8.5-8.5H26.4c-4.7,0-8.5,3.8-8.5,8.5v29.2h254L271.8,181.7L271.8,181.7z"/>
                <circle class="svg-a-rule4" cx="43" cy="192.2" r="6.2"/>
                <circle class="svg-a-rule4" cx="63.6" cy="192.2" r="6.2"/>
                <circle class="svg-a-rule4" cx="84.1" cy="192.2" r="6.2"/>
                <path class="svg-a-rule5" d="M227.9,186h-113c-3.3,0-6.2,2.8-6.2,6.2c0,3.3,2.8,6.2,6.2,6.2h113.2c3.3,0,6.2-2.8,6.2-6.2
                  C234.1,188.8,231.2,186,227.9,186z"/>
                <rect x="44.7" y="234.7" class="svg-a-rule6" width="65.5" height="135.8"/>
                <rect x="127.5" y="291.4" class="svg-a-rule6" width="117.5" height="79.3"/>
                <rect x="127.5" y="234.7" class="svg-a-rule6" width="117.5" height="37"/>
              </g>
            </g>
            <g id="DOM_Virtual">
              <g class="fragment" data-fragment-index="1">
                <line class="svg-a-rule7" x1="528.4" y1="280.3" x2="577.2" y2="352"/>
                <circle class="svg-a-rule9" cx="575.9" cy="353.6" r="23.9"/>
              </g>
              <text transform="matrix(1 0 0 1 384.8565 108.3565)" class="svg-a-rule4 svg-a-rule11 svg-a-rule12">DOM Virtual</text>
              <line class="svg-a-rule8" x1="480.5" y1="205.6" x2="430.7" y2="278.9"/>
              <line class="svg-a-rule8" x1="430.7" y1="278.9" x2="372.7" y2="353.8"/>
              <line class="svg-a-rule8" x1="430.7" y1="278.9" x2="478.5" y2="353.8"/>
              <line class="svg-a-rule8" x1="480.5" y1="205.6" x2="529.4" y2="277.4"/>
              <circle class="svg-a-rule10" cx="480.5" cy="205.6" r="23.9"/>
              <circle class="svg-a-rule10" cx="528" cy="278.9" r="23.9"/>
              <circle class="svg-a-rule10" cx="430.7" cy="278.9" r="23.9"/>
              <circle class="svg-a-rule10" cx="478.5" cy="353.8" r="23.9"/>
              <circle class="svg-a-rule10" cx="372.7" cy="353.8" r="23.9"/>
            </g>
            <g id="DOM_Real">
              <g class="fragment" data-fragment-index="3">
                <circle class="svg-a-rule9" cx="906.4" cy="352.8" r="23.9"/>
                <line class="svg-a-rule7" x1="858.9" y1="279.5" x2="907.7" y2="351.3"/>
              </g>
              <text transform="matrix(1 0 0 1 728.8565 108.3565)" class="svg-a-rule4 svg-a-rule11 svg-a-rule12">DOM Real</text>
              <circle class="svg-a-rule13" cx="811" cy="204.8" r="23.9"/>
              <circle class="svg-a-rule13" cx="858.5" cy="278.2" r="23.9"/>
              <circle class="svg-a-rule13" cx="761.2" cy="278.2" r="23.9"/>
              <circle class="svg-a-rule13" cx="809" cy="353" r="23.9"/>
              <circle class="svg-a-rule13" cx="703.2" cy="353" r="23.9"/>
              <line class="svg-a-rule14" x1="811" y1="204.8" x2="761.2" y2="278.2"/>
              <line class="svg-a-rule14" x1="761.2" y1="278.2" x2="703.2" y2="353"/>
              <line class="svg-a-rule14" x1="761.2" y1="278.2" x2="809" y2="353"/>
              <line class="svg-a-rule14" x1="811" y1="204.8" x2="859.9" y2="276.6"/>
            </g>
            <g id="Reconciliación">
              <text class="fragment svg-a-rule4 svg-a-rule11 svg-a-rule15" data-fragment-index="2" transform="matrix(1 0 0 1 476.0545 538.8836)">RECONCILIACIÓN</text>
              <g class="fragment" data-fragment-index="4">
                <path class="svg-a-rule16" d="M695.5,481.4l-0.1-17.2c-0.1-7.6-6.3-13.8-13.8-13.9l-19-0.2c-7.6-0.1-13.7,6-13.7,13.6l10.8,0.2
                  c1.1-2.2,3.7-3.5,6.4-3.4l12.1,0.2c3.8,0.1,6.9,3.2,6.9,7l0.1,10.3c0,3.8-3,6.8-6.8,6.8l-12.1-0.1c-2.6,0-5.4-1.5-6.6-3.6
                  l-10.6-0.1c0,7.6,6.2,13.8,13.8,13.9l18.9,0.2C689.4,495.1,695.5,489,695.5,481.4z"/>
                <path class="svg-a-rule16" d="M626.1,480.5c-1.2,2.1-4,3.5-6.6,3.5l-11.3-0.1c-3.9,0-7-3.2-7-7.1l-0.1-10.5c0-3.9,3.1-7,7-6.9l11.3,0.1
                  c2.7,0,5.4,1.4,6.6,3.7l11,0.1c-0.1-7.7-6.4-14.1-14.1-14.2l-18.3-0.2c-7.7-0.1-14,6.1-13.9,13.9l0.1,17.5
                  c0.1,7.7,6.4,14.1,14.1,14.2l18.3,0.2c7.7,0.1,14-6.1,13.9-13.8L626.1,480.5z"/>
                <path class="svg-a-rule16" d="M622.5,472c0,2.6,2.1,4.7,4.7,4.8l31.5,0.1c2.6,0,4.8-2.1,4.8-4.7c0-2.6-2.1-4.7-4.7-4.7l-31.5-0.1
                  C624.7,467.3,622.5,469.4,622.5,472z"/>
              </g>
              <g>
                <g class="svg-a-rule17">
                  <line class="svg-a-rule18" x1="643" y1="439.9" x2="643" y2="433.9"/>
                  <line class="svg-a-rule19" x1="643" y1="422" x2="643" y2="25.8"/>
                  <line class="svg-a-rule18" x1="643" y1="19.9" x2="643" y2="13.9"/>
                </g>
              </g>
            </g>
          </svg>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>Todos los cambios que generan nuestros componentes react, ya sea por interacción del usuario o cambios de estado, van a parar al DOM Virtual</li>
              <li>Los cambios se aglutinan en el DOM virtual, se consolidan allí ya que es rápido y barato. Pero no promocionan diréctamente al DOM real.</li>
              <li>Es React quien determina cuando se debe actualizar el DOM Real y en un proceso llamado <b>reconciliación</b>, un algoritmo DIFF evalúa la diferencia entre ambos árboles y determina cuando y qué debe modificarse</li>
              <li>Gracias a la reconciliación, los cambios se propagan al DOM real de manera eficiente, ya que se hacen en 'batch', con el mínimo número de operaciones posible.</li>
              <li>Este proceso de reconciliación, por tanto, sirve como mecanismo de sincronización entre ambos mundos.</li>
              <li>En RESUMEN: <b>React gestiona los cambios en el DOM y lo mantiene actualizado por nosotros de forma eficiente</b></li>
            </ul>
          </aside>
        </section>
      </section>

      <!-- |GRUPO| D3.js -->
      <section>

        <!-- Slide - D3.js Intro -->
        <section>
          <div class="flex-row center">
            <object type="image/svg+xml" data="media/d3_logo.svg" height="75">D3.js Logo</object>
            <h2 class="header-in-row">D3.js</h2>
          </div>
          <ul>
            <li class="fragment">Visualización de datos</li>
            <li class="fragment">API de bajo nivel. Potencia. Flexibilidad.</li>
            <li class="fragment">Declarativo, nos abstrae de modificar el DOM</li>
            <li class="fragment"><i>Data Joins</i>, uniones entre datos y elementos</li>
            <li class="fragment">Tiempo real | Animaciones | Interactividad</li>
          </ul>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>D3.js es un framework, o librería, para la visualización interactiva de datos. Data-Drive-Documents. Al igual que React, es tremendamente popular y se ha convertido en la referencia de facto en este terreno.</li>
              <li>Está conformado por una API de bajo nivel lo que lo hace tremendamente potente y flexible. Es el secreto de su éxito. No es una librería de gráficos pre-hechos, enlatados. Aqui hay que picar, en cambio el límite es la creatividad de cada uno.</li>
              <li>También es declarativo, nos abstrae del DOM. El se encargará de los cambios pertinentes, nosotros le indicamos QUE queremos representar. ¿Nos suena, verdad?</li>
              <li>El mecanismo principal de D3, su core, son las uniones de datos o DATA JOINS. Nos permite establecer literalmente vinculos entre los datos que queremos representar y los elementos gráficos que van a representarlos.</li>
              <li>Al estar datos y elementos vinculado, la visualización no tiene porque ser estática sino que puede responder a los cambios en los datos. Además, admite animaciones, interactividad, etc.</li>
            </ul>
          </aside>
        </section>

        <!-- Slide - Data Joins -->
        <section>
          <h2><i>Data Joins</i></h2>
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           height="600" viewbox="0 0 960 700" style="enable-background:new 0 0 960 700;" xml:space="preserve">
          <defs>
            <style type="text/css">
              .svg-b-rule2{fill:#20232A;}
              .svg-b-rule3{fill:#4F5565;}
              .svg-b-rule4{fill:#FFFFFF;}
              .svg-b-rule5{fill:#22B573;}
              .svg-b-rule6{fill:#006837;}
              .svg-b-rule7{fill:none;stroke:#006837;stroke-width:8;stroke-miterlimit:10;}
              .svg-b-rule8{fill:none;stroke:#B7B7B7;stroke-width:4;stroke-linecap:round;stroke-miterlimit:10;}
              .svg-b-rule9{fill:#00D4EC;stroke:#007E84;stroke-width:4;stroke-linecap:round;stroke-miterlimit:10;}
              .svg-b-rule10{font-family:'Montserrat';}
              .svg-b-rule11{font-size:38px;}
              .svg-b-rule12{fill:#F7D9B0;}
              .svg-b-rule13{fill:#FBB03B;}
              .svg-b-rule14{fill:none;stroke:#F7931E;stroke-width:5;stroke-miterlimit:10;}
              .svg-b-rule15{fill:#FF55F7;stroke:#913391;stroke-width:4;stroke-linecap:round;stroke-miterlimit:10;}
              .svg-b-rule16{fill:#EA6A73;}
              .svg-b-rule17{fill:#C1272D;}
              .svg-b-rule18{fill:none;stroke:#C1272D;stroke-width:8;stroke-miterlimit:10;}
              .svg-b-rule19{fill:none;stroke:#9BAAC9;stroke-width:4;stroke-linecap:round;stroke-miterlimit:10;stroke-dasharray:12.1659,12.1659;}
            </style>
          </defs>
          <g id="Enter" class="fragment" data-fragment-index="1">
            <g id="Tabla_1">
              <path class="svg-b-rule3" d="M281.7,67.3c0-3.3-2.7-5.9-6-5.9H109.9c-3.3,0-5.9,2.7-5.9,5.9v20.4h177.8L281.7,67.3L281.7,67.3z"/>
              <g>
                <rect x="104.4" y="88.4" class="svg-b-rule4" width="176.9" height="28.3"/>
                <path class="svg-b-rule3" d="M280.8,88.9v27.3H104.9V88.9H280.8 M281.8,87.9H103.9v29.3h177.9V87.9L281.8,87.9z"/>
              </g>
              <g>
                <path class="svg-b-rule4" d="M109.9,171.6c-3,0-5.5-2.5-5.5-5.5v-22.8h176.9v22.8c0,3-2.5,5.5-5.5,5.5H109.9z"/>
                <path class="svg-b-rule3" d="M280.8,143.9v22.3c0,2.8-2.2,5-5,5H109.9c-2.8,0-5-2.2-5-5v-22.3H280.8 M281.8,142.9H103.9v23.3
                  c0,3.3,2.7,6,6,6h165.9c3.3,0,6-2.7,6-6V142.9L281.8,142.9z"/>
              </g>
              <g>
                <rect x="118.6" y="112.6" class="svg-b-rule5" width="173.9" height="34"/>
                <path class="svg-b-rule6" d="M290.5,114.6v30H120.6v-30H290.5 M294.5,110.6H116.6v38h177.9V110.6L294.5,110.6z"/>
              </g>
              <g>
                <g>
                  <line class="svg-b-rule7" x1="89.7" y1="118.5" x2="89.7" y2="142.3"/>
                </g>
                <line class="svg-b-rule7" x1="77.7" y1="130.4" x2="101.7" y2="130.4"/>
              </g>
            </g>
            <g id="Flecha_1">
              <line class="svg-b-rule8" x1="384.7" y1="118.5" x2="632.7" y2="118.5"/>
              <line class="svg-b-rule8" x1="632.7" y1="118.5" x2="614.9" y2="100.7"/>
              <line class="svg-b-rule8" x1="614.9" y1="136.3" x2="632.7" y2="118.5"/>
            </g>
            <circle id="Circulo_1" class="svg-b-rule9" cx="786.3" cy="118.5" r="42.5"/>
          </g>
          <g id="Update" class="fragment" data-fragment-index="2">
            <g id="Tabla_2">
              <path class="svg-b-rule3" d="M281.7,289.8c0-3.3-2.7-5.9-6-5.9H109.9c-3.3,0-5.9,2.7-5.9,5.9v20.4h177.8L281.7,289.8L281.7,289.8z"/>
              <g>
                <rect x="104.4" y="310.9" class="svg-b-rule4" width="176.9" height="28.3"/>
                <path class="svg-b-rule3" d="M280.8,311.4v27.3H104.9v-27.3H280.8 M281.8,310.4H103.9v29.3h177.9V310.4L281.8,310.4z"/>
              </g>
              <g>
                <path class="svg-b-rule4" d="M109.9,394.1c-3,0-5.5-2.5-5.5-5.5v-22.8h176.9v22.8c0,3-2.5,5.5-5.5,5.5H109.9z"/>
                <path class="svg-b-rule3" d="M280.8,366.4v22.3c0,2.8-2.2,5-5,5H109.9c-2.8,0-5-2.2-5-5v-22.3H280.8 M281.8,365.4H103.9v23.3
                  c0,3.3,2.7,6,6,6h165.9c3.3,0,6-2.7,6-6V365.4L281.8,365.4z"/>
              </g>
              <g>
                <rect x="96.5" y="335.1" class="svg-b-rule12" width="190" height="34"/>
                <path class="svg-b-rule13" d="M284.5,337.1v30h-186v-30H284.5 M288.5,333.1h-194v38h194V333.1L288.5,333.1z"/>
              </g>
              <g>
                <line class="svg-b-rule14" x1="110.7" y1="351.9" x2="134.7" y2="351.9"/>
                <line class="svg-b-rule14" x1="114" y1="360.5" x2="131" y2="343.5"/>
                <line class="svg-b-rule14" x1="122.8" y1="364.1" x2="122.8" y2="340.1"/>
                <line class="svg-b-rule14" x1="131.2" y1="360.5" x2="114.3" y2="343.6"/>
              </g>
            </g>
            <g id="Flecha_2">
              <line class="svg-b-rule8" x1="384.7" y1="341" x2="632.7" y2="341"/>
              <line class="svg-b-rule8" x1="632.7" y1="341" x2="614.9" y2="323.2"/>
              <line class="svg-b-rule8" x1="614.9" y1="358.8" x2="632.7" y2="341"/>
            </g>
            <circle id="Circulo_2" class="svg-b-rule15" cx="786.3" cy="341" r="65.8"/>
          </g>
          <g id="Exit" class="fragment" data-fragment-index="3">
            <g id="Tabla_3">
              <path class="svg-b-rule3" d="M281.7,510.8c0-3.3-2.7-5.9-6-5.9H109.9c-3.3,0-5.9,2.7-5.9,5.9v20.4h177.8L281.7,510.8L281.7,510.8z"/>
              <g>
                <rect x="104.4" y="531.9" class="svg-b-rule4" width="176.9" height="28.3"/>
                <path class="svg-b-rule3" d="M280.8,532.4v27.3H104.9v-27.3H280.8 M281.8,531.4H103.9v29.3h177.9V531.4L281.8,531.4z"/>
              </g>
              <g>
                <path class="svg-b-rule4" d="M109.9,615.1c-3,0-5.5-2.5-5.5-5.5v-22.8h176.9v22.8c0,3-2.5,5.5-5.5,5.5H109.9z"/>
                <path class="svg-b-rule3" d="M280.8,587.4v22.3c0,2.8-2.2,5-5,5H109.9c-2.8,0-5-2.2-5-5v-22.3H280.8 M281.8,586.4H103.9v23.3
                  c0,3.3,2.7,6,6,6h165.9c3.3,0,6-2.7,6-6V586.4L281.8,586.4z"/>
              </g>
              <g>
                <rect x="90.6" y="556.1" class="svg-b-rule16" width="173.9" height="34"/>
                <path class="svg-b-rule17" d="M262.5,558.1v30H92.6v-30H262.5 M266.5,554.1H88.6v38h177.9V554.1L266.5,554.1z"/>
              </g>
              <g>
                <line class="svg-b-rule18" x1="279.7" y1="573.9" x2="303.7" y2="573.9"/>
              </g>
            </g>
            <g id="Flecha_3">
              <line class="svg-b-rule8" x1="384.7" y1="562" x2="632.7" y2="562"/>
              <line class="svg-b-rule8" x1="632.7" y1="562" x2="614.9" y2="544.2"/>
              <line class="svg-b-rule8" x1="614.9" y1="579.8" x2="632.7" y2="562"/>
            </g>
            <g id="Circulo_3">
                <ellipse transform="matrix(0.7071 -0.7071 0.7071 0.7071 -167.0898 720.6096)" class="svg-b-rule19" cx="786.3" cy="562" rx="65.8" ry="65.8"/>
            </g>
          </g>
          <g id="Textos" class="fragment" data-fragment-index="4">
            <text transform="matrix(1 0 0 1 458.5232 198.0232)" class="svg-b-rule4 svg-b-rule10 svg-b-rule11">Enter</text>
            <text transform="matrix(1 0 0 1 436.8565 422.6898)" class="svg-b-rule4 svg-b-rule10 svg-b-rule11">Update</text>
            <text transform="matrix(1 0 0 1 465.5233 641.3565)" class="svg-b-rule4 svg-b-rule10 svg-b-rule11">Exit</text>
          </g>
          </svg>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>Vamos a hacer un ejercicio mental muy sencillo para entender rápidamente las uniones de datos.</li>
              <li>Imaginemos que tenemos una tabla de paises con datos como por ejemplo, número de habitantes, renta per cápita, esperanza de vida, etc.</li>
              <li>Si quisieramos representar estos datos gráficamente, lo primero que pensaríamos sería: por cada fila, es decir por cada pais, voy a pintar un círculo por ejemplo.</li>
              <li>El tamaño de ese círculo vendrá dado por el número de habitantes. El color, por el continente al que pertenece.</li>
              <li>Finalmente su posición vendrá dada por su riqueza, los paises más ricos hacia la derecha, los más saludables (esperanza de vida) hacia arriba.</li>
              <li>COROLARIO: Hemos asociado cada fila de la tabla, cada pais, a un círculo (que es el elemento que va a representarlo en el gráfico). Y hemos dado forma, color y posición a ese círculo según los datos.</li>
              <li>
                Esta es la forma en la que se trabaja en D3.js, y los 3 escenarios representados son intencionados ya que D3 distingue entre estas 3 circunstancias entro de un data join:
                <ul>
                  <li>Nuevos datos se vinculan a nuevos elementos. Se le conoce como sub-grupo ENTER.</li>
                  <li>Cuando un dato se modifica, también lo hará el elemento asociado. Sub-grupo UPDATE.</li>
                  <li>Datos eliminados generan elementos huérfanos, que por lo general acaban siendo borrados del gráfico. Sub-grupo EXIT.</li>
                </ul>
              </li>
              <li>A esto se le conoce como patrón ENTER-UPDATE-EXIT.</li>

            </ul>
          </aside>
        </section>

        <!-- Slide - Selecciones -->
        <section>
          <h2>Selecciones</h2>
            <pre><code class="code-area js" data-trim="true" data-noescape="true">
              const paises = [...];
              const circulos = chart.selectAll("circle")
                  .data(paises)
                  .enter()
                  .append("circle")
                    .attr("cx", pais => xScale(pais.poderAdquisitivo))
                    .attr("cy", pais => yScale(pais.esperanzaVida))
                    .attr("r", pais => areaScale(pais.habitantes))
                    .attr("fill", pais => color(pais.continente));
            </code></pre>

            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="120"
              class="fragment smallfont" style="margin-top: 2rem;">
              <defs>
                <style>
                  .smallfont {font: 10px sans-serif;}
                  .join,.link,.node rect {fill: none;stroke-width: 1.5px;}
                  .link {stroke: #969696;}
                  .node rect {fill: white;}
                  .node .element rect {fill: #bdbdbd;stroke: none;}
                  .node .datum rect {fill: #d9d9d9;stroke: none;}
                  .node .key rect {fill: #00eccc;stroke: none;}
                  .link .to-key,.join {stroke: #00eccc;}
                  .join {stroke-dasharray: 2, 2;}
                  .link .from-data {stroke: #ff55f7;}
                  .link .from-selection {stroke: #ff55f7;}
                </style>
              </defs>
              <g class="left" transform="translate(40,0)">
                <g class="link">
                  <path class="to-array from-selection" d="M51.4677734375,60C75.73388671875,60 75.73388671875,60 100,60"></path>
                  <path class="to-element from-array" d="M137.576171875,60C168.7880859375,60 168.7880859375,12 200,12"></path>
                  <path class="to-element from-array" d="M137.576171875,60C168.7880859375,60 168.7880859375,36 200,36"></path>
                  <path class="to-element from-array" d="M137.576171875,60C168.7880859375,60 168.7880859375,60 200,60"></path>
                  <path class="to-element from-array" d="M137.576171875,60C168.7880859375,60 168.7880859375,84 200,84"></path>
                  <path class="to-element from-array" d="M137.576171875,60C168.7880859375,60 168.7880859375,108 200,108"></path>
                  <path class="to-key from-element" d="M247.576171875,12C273.7880859375,12 273.7880859375,12 300,12"></path>
                  <path class="to-key from-element" d="M247.576171875,36C273.7880859375,36 273.7880859375,36 300,36"></path>
                  <path class="to-key from-element" d="M247.576171875,60C273.7880859375,60 273.7880859375,60 300,60"></path>
                  <path class="to-key from-element" d="M247.576171875,84C273.7880859375,84 273.7880859375,84 300,84"></path>
                  <path class="to-key from-element" d="M247.576171875,108C273.7880859375,108 273.7880859375,108 300,108"></path>
                </g>
                <g class="node">
                  <g class="selection" transform="translate(0,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="51.4677734375"></rect>
                    <text dy=".35em" x="6">selection</text>
                  </g>
                  <g class="array" transform="translate(100,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="37.576171875"></rect>
                    <text dy=".35em" x="6">group</text>
                  </g>
                  <g class="element" transform="translate(200,12)">
                    <rect ry="6" rx="6" y="-10" height="20" width="47.576171875"></rect>
                    <text dy=".35em" x="6">element</text>
                  </g>
                  <g class="key" transform="translate(300,12)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32"></rect>
                    <path class="join" d="M32,0C60,0 60,48 88,48"></path>
                    <text dy=".35em" x="6">A</text>
                  </g>
                  <g class="element" transform="translate(200,36)">
                    <rect ry="6" rx="6" y="-10" height="20" width="47.576171875"></rect>
                    <text dy=".35em" x="6">element</text>
                  </g>
                  <g class="key" transform="translate(300,36)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32"></rect>
                    <text dy=".35em" x="6">B</text>
                  </g>
                  <g class="element" transform="translate(200,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="47.576171875"></rect>
                    <text dy=".35em" x="6">element</text>
                  </g>
                  <g class="key" transform="translate(300,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32"></rect>
                    <text dy=".35em" x="6">C</text>
                  </g>
                  <g class="element" transform="translate(200,84)">
                    <rect ry="6" rx="6" y="-10" height="20" width="47.576171875"></rect>
                    <text dy=".35em" x="6">element</text>
                  </g>
                  <g class="key" transform="translate(300,84)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32"></rect>
                    <text dy=".35em" x="6">D</text>
                  </g>
                  <g class="element" transform="translate(200,108)">
                    <rect ry="6" rx="6" y="-10" height="20" width="47.576171875"></rect>
                    <text dy=".35em" x="6">element</text>
                  </g>
                  <g class="key" transform="translate(300,108)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32"></rect>
                    <path class="join" d="M32,0C60,0 60,-72 88,-72"></path>
                    <text dy=".35em" x="6">E</text>
                  </g>
                </g>
              </g>
              <g class="right" transform="translate(760,0)">
                <g class="link">
                  <path class="to-array from-data" d="M-32,60C-66,60 -66,60 -100,60"></path>
                  <path class="to-datum from-array" d="M-134.783203125,60C-167.3916015625,60 -167.3916015625,12 -200,12"></path>
                  <path class="to-datum from-array" d="M-134.783203125,60C-167.3916015625,60 -167.3916015625,36 -200,36"></path>
                  <path class="to-datum from-array" d="M-134.783203125,60C-167.3916015625,60 -167.3916015625,60 -200,60"></path>
                  <path class="to-datum from-array" d="M-134.783203125,60C-167.3916015625,60 -167.3916015625,84 -200,84"></path>
                  <path class="to-datum from-array" d="M-134.783203125,60C-167.3916015625,60 -167.3916015625,108 -200,108"></path>
                  <path class="to-key from-datum" d="M-232,12C-266,12 -266,12 -300,12"></path>
                  <path class="to-key from-datum" d="M-232,36C-266,36 -266,36 -300,36"></path>
                  <path class="to-key from-datum" d="M-232,60C-266,60 -266,60 -300,60"></path>
                  <path class="to-key from-datum" d="M-232,84C-266,84 -266,84 -300,84"></path>
                  <path class="to-key from-datum" d="M-232,108C-266,108 -266,108 -300,108"></path>
                </g>
                <g class="node">
                  <g class="data" transform="translate(0,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">data</text>
                  </g>
                  <g class="array" transform="translate(-100,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="34.783203125" x="-34.783203125"></rect>
                    <text dy=".35em" x="-28.783203125">array</text>
                  </g>
                  <g class="datum" transform="translate(-200,12)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">Y</text>
                  </g>
                  <g class="key" transform="translate(-300,12)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">Y</text>
                  </g>
                  <g class="datum" transform="translate(-200,36)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">E</text>
                  </g>
                  <g class="key" transform="translate(-300,36)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">E</text>
                  </g>
                  <g class="datum" transform="translate(-200,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">A</text>
                  </g>
                  <g class="key" transform="translate(-300,60)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">A</text>
                  </g>
                  <g class="datum" transform="translate(-200,84)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">O</text>
                  </g>
                  <g class="key" transform="translate(-300,84)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">O</text>
                  </g>
                  <g class="datum" transform="translate(-200,108)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">I</text>
                  </g>
                  <g class="key" transform="translate(-300,108)">
                    <rect ry="6" rx="6" y="-10" height="20" width="32" x="-32"></rect>
                    <text dy=".35em" x="-26">I</text>
                  </g>
                </g>
              </g>
            </svg>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>¿Cómo se expresan o aplican las uniones de datos en código? Mediantes las selecciones. El core de D3.js incorpora funcionalidad para seleccionar elementos del DOM, muy al estilo de JQuery.</li>
              <li>En primer lugar, seleccionamos todos los elementos de tipo círculo. D3 es compatible con los selectores de css que conocemos.</li>
              <li>A continuación establecemos el data join, vinculamos los datos a nuestros elementos seleccionados. Se hace con el método data(). Los datos siempre serán un array, cada item del array se vincula a un elemento mediante una función de mapeo que por defecto es el índice.</li>
              <li>Por último operamos sobre el sub-grupo que nos interesa, enter, exit o update. En nuestro caso, añadimos (append) un elemento círculo por cada pais.</li>
              <li>A la selección establecida vamos aplicando las propiedades para darle una posición, tamaño y color en función de los datos del pais.</li>
              <li>COROLARIO: (gráfico bostock) Con este ejemplo lo que pretendía ilustrar es que D3 cuenta con un potente mecanismo, los data joins, para gestionar el DOM por nosotros. ¿nos suena verdad?</li>
              <li>En el fondo, estas uniones entre datos y elementos sirven como algoritmo diff mediante el cual evaluar que parte del DOM hay que mutar, y gracias al patrón enter-update-exit, actuar de un modo u otro. Asi se puede ser mucho más preciso y eficiente.</li>
            </ul>
          </aside>
        </section>

        <!-- Slide - Sample -->
        <section>
          <h4>Riqueza por Paises</h4>
          <iframe style="background-color: white" data-src="https://fjcalzado.github.io/DemoSeries-D3JS-Bubble-Chart/" width="100%" height="560"></iframe>
          <a target="_blank" href="https://fjcalzado.github.io/DemoSeries-D3JS-Bubble-Chart/">Github</a>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>Por si teníais curiosidad, aqui tenéis el ejemplo anterior implementado con D3 de verdad.</li>
              <li>En este caso sólo se ha operado sobre el sub-grupo ENTER, es decir, sólo se añaden nuevos círculos con cada pais en la lista, ya que los datos son estáticos, no van a cambiar.</li>
              <li>No obstante si que se han añadido eventos para mostrar un popup animado, etc, para que veáis que D3 permite interacción con los elementos.</li>
            </ul>
          </aside>
        </section>

      </section>

      <!-- |GRUPO| Pugna por el DOM -->
      <section>

        <!-- Slide - Qué Sucederá -->
        <section>
          <div class="flex-row spaced">
            <object type="image/svg+xml" data="media/react_logo.svg" height="100">React Logo</object>
            <svg class="fragment" data-fragment-index="1" width="100" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 252 39.51">
              <defs>
                <style>
                  .flecha{fill:none;stroke:#b7b7b7;stroke-linecap:round;stroke-miterlimit:10;stroke-width:4px;}
                </style>
              </defs>
              <g id="Flecha_4">
                <line class="flecha" x1="2" y1="19.76" x2="250" y2="19.76"/>
                <line class="flecha" x1="250" y1="19.76" x2="232.24" y2="2"/>
                <line class="flecha" x1="232.24" y1="37.51" x2="250" y2="19.76"/>
              </g>
            </svg>
            <h2 style="margin:0;padding:15px;border:2px solid white;border-radius:10px;">DOM</h2>
            <svg class="fragment" data-fragment-index="1" style="transform:rotate(180deg)" width="100" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 252 39.51">
              <defs>
                <style>
                  .flecha{fill:none;stroke:#b7b7b7;stroke-linecap:round;stroke-miterlimit:10;stroke-width:4px;}
                </style>
              </defs>
              <g id="Flecha_5">
                <line class="flecha" x1="2" y1="19.76" x2="250" y2="19.76"/>
                <line class="flecha" x1="250" y1="19.76" x2="232.24" y2="2"/>
                <line class="flecha" x1="232.24" y1="37.51" x2="250" y2="19.76"/>
              </g>
            </svg>
            <object type="image/svg+xml" data="media/d3_logo.svg" height="100">React Logo</object>
          </div>

          <!-- Notas -->
          <aside class="notes">
            <ul>
              <li>Resumen de lo visto hasta ahora en 1 frase: Tanto React como D3 tienen en común la gestión eficiente del DOM. En el caso de React mediante el DOM virtual, y en el caso de D3 gracias a las selecciones, los data joins y el patrón enter-update-exit.</li>
              <li>Pero ambos van a controlar el DOM real por nosotros.</li>
              <li>¿Qué pensáis que sucederá entonces si los ponemos a trabajar juntos? ¿Lo adivináis? Ya os lo digo yo ...</li>
            </ul>
          </aside>
        </section>

        <!-- Slide - A tortas -->
        <section data-background="./media/fight.gif">
          <h2 class="text-shadow">¡A tortas por el DOM!</h2>
        </section>

        <!-- Slide - Test de colisión -->
        <section>
          <h2 style="margin-bottom:40px">Test de colisión</h2>
          <div id="react-d3-sample01" class="flex-row center"></div>
        </section>

      </section>








      <section>
        <h2>Prueba Sample 00</h2>
        <div id="react-d3-sample00"></div>
      </section>

      <section>
      </section>

      <section data-background-iframe="https://fjcalzado.github.io/DemoSeries-D3JS-Bubble-Chart/">
        <h4>iFrame en background</h4>
      </section>

      <section>
        <p>Probando un link externo en iframe</p>
        <a data-preview-link="true" href="https://fjcalzado.github.io/DemoSeries-D3JS-Bubble-Chart/">Link</a>
      </section>

      <section data-background-color="#fff" data-background="https://media.giphy.com/media/lueaDWxOz0LNS/giphy.gif">
        <h2>... pelea asegurada!</h2>
      </section>


    </div>
  </div>





  <!-- RECURSOS y CONFIGURACIÓN REVEAL.js -->
  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.js"></script>
  <script>
    // Detectamos si es master/client y extrae la clave (key/secret) mediante el parámetro K de la URL.
    const master = Boolean(Reveal.getQueryHash().k);
    const masterKey = master ? Reveal.getQueryHash().k : null;

    Reveal.initialize({
      controls: true,
      controlsTutorial: true,
      progress: true,
      history: true, // Intersante para desarrollo. Mantiene histórico de URLs con #
      center: true,
      maxScale: 4.0,
      viewDistance: 3,  // Distancia de Lazy loading medida en slides, (contenido/recursos a cargar de las x slides por delante de la actual).
      transition: 'slide', // Opciones: none/fade/slide/convex/concave/zoom.

      multiplex: {
        secret: masterKey, // null o la clave/secreto, según sea el cliente o master el que se haya conectado.
        id: 'a45de79095c017f5', // id, obtenida del servidor socket.io.
        url: 'https://reveal-multiplex-fjcalzado.herokuapp.com/' // Ubicación de nuestro servidor socket.io.
      },

      dependencies: [
        { src: 'lib/js/socket.io.slim.js', async: true },
        { src: master ? 'plugin/multiplex/master.js' : 'plugin/multiplex/client.js', async: true }, // Añadimos el script para el multiplex que corresponda (master vs client).
        { src: 'lib/js/classList.js', condition: function () { return !document.body.classList; } },
        { src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
        { src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
        { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
        { src: 'plugin/search/search.js', async: true },
        { src: 'plugin/zoom-js/zoom.js', async: true },
        { src: master ? 'plugin/notes/notes.js' : '', async: true } // Permitir notas de presentador sólo para el masterr.
      ]
    });
  </script>

  <!-- RECURSOS Para ejemplos empotrados React + D3.js -->
  <script type="text/javascript" src="samples/dist/manifest.js"></script>
  <script type="text/javascript" src="samples/dist/vendor.js"></script>
  <script type="text/javascript" src="samples/dist/reactD3Samples.js"></script>

</body>

</html>
